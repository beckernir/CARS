<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Child Protection Services - Regional Dashboard</title>-->
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>-->
<!--    <style>-->
<!--        :root {-->
<!--            &#45;&#45;primary: #2563eb;-->
<!--            &#45;&#45;primary-dark: #1d4ed8;-->
<!--            &#45;&#45;secondary: #475569;-->
<!--            &#45;&#45;success: #16a34a;-->
<!--            &#45;&#45;danger: #dc2626;-->
<!--            &#45;&#45;warning: #eab308;-->
<!--            &#45;&#45;light-bg: #f8fafc;-->
<!--            &#45;&#45;card-bg: #ffffff;-->
<!--            &#45;&#45;text: #1e293b;-->
<!--            &#45;&#45;text-light: #64748b;-->
<!--            &#45;&#45;border: #e2e8f0;-->
<!--        }-->

<!--        * {-->
<!--            margin: 0;-->
<!--            padding: 0;-->
<!--            box-sizing: border-box;-->
<!--            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;-->
<!--        }-->

<!--        body {-->
<!--            background-color: var(&#45;&#45;light-bg);-->
<!--            color: var(&#45;&#45;text);-->
<!--        }-->

<!--        .container {-->
<!--            max-width: 1280px;-->
<!--            margin: 0 auto;-->
<!--            padding: 1rem;-->
<!--        }-->

<!--        header {-->
<!--            background-color: var(&#45;&#45;card-bg);-->
<!--            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);-->
<!--            padding: 1rem 0;-->
<!--            position: sticky;-->
<!--            top: 0;-->
<!--            z-index: 100;-->
<!--        }-->

<!--        h1 {-->
<!--            font-size: 1.5rem;-->
<!--            color: var(&#45;&#45;primary);-->
<!--            text-align: center;-->
<!--        }-->

<!--        .dashboard {-->
<!--            padding: 1.5rem 0;-->
<!--        }-->

<!--        .controls {-->
<!--            display: flex;-->
<!--            gap: 1rem;-->
<!--            margin-bottom: 1.5rem;-->
<!--            flex-wrap: wrap;-->
<!--        }-->

<!--        select, input, button {-->
<!--            padding: 0.5rem 1rem;-->
<!--            border: 1px solid var(&#45;&#45;border);-->
<!--            border-radius: 0.375rem;-->
<!--            background-color: var(&#45;&#45;card-bg);-->
<!--            cursor: pointer;-->
<!--            transition: all 0.2s;-->
<!--        }-->

<!--        button {-->
<!--            background-color: var(&#45;&#45;primary);-->
<!--            color: white;-->
<!--            border: 1px solid var(&#45;&#45;primary);-->
<!--        }-->

<!--        button:hover {-->
<!--            background-color: var(&#45;&#45;primary-dark);-->
<!--        }-->

<!--        select:hover, input:hover {-->
<!--            border-color: var(&#45;&#45;primary);-->
<!--        }-->

<!--        .dashboard-title {-->
<!--            font-size: 1.25rem;-->
<!--            font-weight: 600;-->
<!--        }-->

<!--        .overview-cards {-->
<!--            display: grid;-->
<!--            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));-->
<!--            gap: 1rem;-->
<!--            margin-bottom: 1.5rem;-->
<!--        }-->

<!--        .card {-->
<!--            background-color: var(&#45;&#45;card-bg);-->
<!--            border-radius: 0.5rem;-->
<!--            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);-->
<!--            padding: 1.25rem;-->
<!--            transition: transform 0.2s, box-shadow 0.2s;-->
<!--        }-->

<!--        .card:hover {-->
<!--            transform: translateY(-2px);-->
<!--            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);-->
<!--        }-->

<!--        .card-title {-->
<!--            color: var(&#45;&#45;text-light);-->
<!--            font-size: 0.875rem;-->
<!--            margin-bottom: 0.5rem;-->
<!--        }-->

<!--        .card-value {-->
<!--            font-size: 1.875rem;-->
<!--            font-weight: 600;-->
<!--            margin-bottom: 0.5rem;-->
<!--            transition: color 0.3s;-->
<!--        }-->

<!--        .card:hover .card-value {-->
<!--            color: var(&#45;&#45;primary);-->
<!--        }-->

<!--        .card-footer {-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            font-size: 0.875rem;-->
<!--        }-->

<!--        .trend-up {-->
<!--            color: var(&#45;&#45;success);-->
<!--        }-->

<!--        .trend-down {-->
<!--            color: var(&#45;&#45;danger);-->
<!--        }-->

<!--        .grid-section {-->
<!--            display: grid;-->
<!--            grid-template-columns: 2fr 1fr;-->
<!--            gap: 1rem;-->
<!--            margin-bottom: 1.5rem;-->
<!--        }-->

<!--        .chart-container {-->
<!--            background-color: var(&#45;&#45;card-bg);-->
<!--            border-radius: 0.5rem;-->
<!--            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);-->
<!--            padding: 1.25rem;-->
<!--            position: relative;-->
<!--        }-->

<!--        .chart-header {-->
<!--            display: flex;-->
<!--            justify-content: space-between;-->
<!--            align-items: center;-->
<!--            margin-bottom: 1rem;-->
<!--        }-->

<!--        .chart-header h3 {-->
<!--            margin: 0;-->
<!--            color: var(&#45;&#45;text);-->
<!--        }-->

<!--        .data-grid {-->
<!--            display: grid;-->
<!--            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));-->
<!--            gap: 1rem;-->
<!--        }-->

<!--        .data-table {-->
<!--            width: 100%;-->
<!--            border-collapse: collapse;-->
<!--            font-size: 0.875rem;-->
<!--        }-->

<!--        .data-table th {-->
<!--            text-align: left;-->
<!--            padding: 0.75rem;-->
<!--            border-bottom: 2px solid var(&#45;&#45;border);-->
<!--            color: var(&#45;&#45;text-light);-->
<!--            font-weight: 500;-->
<!--        }-->

<!--        .data-table td {-->
<!--            padding: 0.75rem;-->
<!--            border-bottom: 1px solid var(&#45;&#45;border);-->
<!--            transition: background-color 0.2s;-->
<!--        }-->

<!--        .data-table tbody tr:hover {-->
<!--            background-color: var(&#45;&#45;light-bg);-->
<!--        }-->

<!--        .badge {-->
<!--            display: inline-block;-->
<!--            padding: 0.25rem 0.5rem;-->
<!--            border-radius: 9999px;-->
<!--            font-size: 0.75rem;-->
<!--            font-weight: 500;-->
<!--            cursor: pointer;-->
<!--            transition: all 0.2s;-->
<!--        }-->

<!--        .badge:hover {-->
<!--            transform: scale(1.05);-->
<!--        }-->

<!--        .badge-success {-->
<!--            background-color: rgba(22, 163, 74, 0.1);-->
<!--            color: var(&#45;&#45;success);-->
<!--        }-->

<!--        .badge-warning {-->
<!--            background-color: rgba(234, 179, 8, 0.1);-->
<!--            color: var(&#45;&#45;warning);-->
<!--        }-->

<!--        .badge-danger {-->
<!--            background-color: rgba(220, 38, 38, 0.1);-->
<!--            color: var(&#45;&#45;danger);-->
<!--        }-->

<!--        .loading {-->
<!--            opacity: 0.6;-->
<!--            pointer-events: none;-->
<!--        }-->

<!--        .notification {-->
<!--            position: fixed;-->
<!--            top: 20px;-->
<!--            right: 20px;-->
<!--            padding: 1rem;-->
<!--            border-radius: 0.5rem;-->
<!--            color: white;-->
<!--            font-weight: 500;-->
<!--            transform: translateX(100%);-->
<!--            transition: transform 0.3s;-->
<!--            z-index: 1000;-->
<!--        }-->

<!--        .notification.show {-->
<!--            transform: translateX(0);-->
<!--        }-->

<!--        .notification.success {-->
<!--            background-color: var(&#45;&#45;success);-->
<!--        }-->

<!--        .notification.error {-->
<!--            background-color: var(&#45;&#45;danger);-->
<!--        }-->

<!--        .error-message {-->
<!--            background-color: #fee2e2;-->
<!--            color: #dc2626;-->
<!--            padding: 1rem;-->
<!--            border-radius: 0.5rem;-->
<!--            margin: 1rem 0;-->
<!--            border-left: 4px solid #dc2626;-->
<!--        }-->

<!--        @media (max-width: 768px) {-->
<!--            .grid-section {-->
<!--                grid-template-columns: 1fr;-->
<!--            }-->

<!--            .controls {-->
<!--                flex-direction: column;-->
<!--            }-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--<header>-->
<!--    <div class="container">-->
<!--        <h1>Child Protection Services - Regional Dashboard</h1>-->
<!--    </div>-->
<!--</header>-->

<!--<div class="container dashboard">-->
<!--    <div class="controls">-->
<!--        <select id="regionFilter">-->
<!--            <option value="all">All Regions</option>-->
<!--            <option value="northern">Northern District</option>-->
<!--            <option value="eastern">Eastern District</option>-->
<!--            <option value="central">Central District</option>-->
<!--            <option value="western">Western District</option>-->
<!--        </select>-->

<!--        <select id="caseTypeFilter">-->
<!--            <option value="all">All Case Types</option>-->
<!--            <option value="PHYSICAL_ABUSE">Physical Abuse</option>-->
<!--            <option value="EMOTIONAL_ABUSE">Emotional Abuse</option>-->
<!--            <option value="SEXUAL_ABUSE">Sexual Abuse</option>-->
<!--            <option value="NEGLECT">Neglect</option>-->
<!--        </select>-->

<!--        <input type="date" id="dateFrom" value="2025-01-01">-->
<!--        <input type="date" id="dateTo" value="2025-05-28">-->

<!--        <button onclick="refreshData()">Refresh Data</button>-->
<!--        <button onclick="exportData()">Export Report</button>-->
<!--    </div>-->

<!--    <div class="overview-cards">-->
<!--        <div class="card" onclick="showCaseDetails('total')">-->
<!--            <div class="card-title">Total Case Reports</div>-->
<!--            <div class="card-value" id="totalCases">Loading...</div>-->
<!--            <div class="card-footer">-->
<!--                <span id="totalCasesTrend">&#45;&#45;</span>-->
<!--                <span style="margin-left: 0.5rem; color: var(&#45;&#45;text-light);">vs previous period</span>-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="card" onclick="showCaseDetails('active')">-->
<!--            <div class="card-title">Active Cases</div>-->
<!--            <div class="card-value" id="activeCases">Loading...</div>-->
<!--            <div class="card-footer">-->
<!--                <span id="activeCasesTrend">&#45;&#45;</span>-->
<!--                <span style="margin-left: 0.5rem; color: var(&#45;&#45;text-light);">currently active</span>-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="card" onclick="showCaseDetails('closed')">-->
<!--            <div class="card-title">Closed Cases</div>-->
<!--            <div class="card-value" id="closedCases">Loading...</div>-->
<!--            <div class="card-footer">-->
<!--                <span id="closedCasesTrend">&#45;&#45;</span>-->
<!--                <span style="margin-left: 0.5rem; color: var(&#45;&#45;text-light);">resolved cases</span>-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="card" onclick="showCaseDetails('reported')">-->
<!--            <div class="card-title">Reported Cases</div>-->
<!--            <div class="card-value" id="reportedCases">Loading...</div>-->
<!--            <div class="card-footer">-->
<!--                <span id="reportedCasesTrend">&#45;&#45;</span>-->
<!--                <span style="margin-left: 0.5rem; color: var(&#45;&#45;text-light);">pending investigation</span>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

<!--    <div class="grid-section">-->
<!--        <div class="chart-container">-->
<!--            <div class="chart-header">-->
<!--                <h3>Reports by Region</h3>-->
<!--                <select id="regionChartFilter" onchange="updateRegionChart()">-->
<!--                    <option value="all">All Case Types</option>-->
<!--                    <option value="PHYSICAL_ABUSE">Physical Abuse</option>-->
<!--                    <option value="EMOTIONAL_ABUSE">Emotional Abuse</option>-->
<!--                    <option value="NEGLECT">Neglect</option>-->
<!--                    <option value="SEXUAL_ABUSE">Sexual Abuse</option>-->
<!--                </select>-->
<!--            </div>-->
<!--            <canvas id="regionChart" style="height: 250px;"></canvas>-->
<!--        </div>-->
<!--        <div class="chart-container">-->
<!--            <div class="chart-header">-->
<!--                <h3>Case Types Distribution</h3>-->
<!--            </div>-->
<!--            <canvas id="pieChart" style="height: 250px;"></canvas>-->
<!--        </div>-->
<!--    </div>-->

<!--    <div class="chart-container" style="margin-bottom: 1.5rem;">-->
<!--        <div class="chart-header">-->
<!--            <h3>Monthly Trends</h3>-->
<!--            <select id="trendPeriod" onchange="updateTrendChart()">-->
<!--                <option value="6">Last 6 Months</option>-->
<!--                <option value="12" selected>Last 12 Months</option>-->
<!--                <option value="24">Last 24 Months</option>-->
<!--            </select>-->
<!--        </div>-->
<!--        <canvas id="trendChart" style="height: 300px;"></canvas>-->
<!--    </div>-->

<!--    <div class="data-grid">-->
<!--        <div class="card">-->
<!--            <div class="chart-header">-->
<!--                <h3>Recent Active Cases</h3>-->
<!--                <a href="#" onclick="viewAllCases()" style="color: var(&#45;&#45;primary); text-decoration: none; font-size: 0.875rem;">View All</a>-->
<!--            </div>-->
<!--            <table class="data-table">-->
<!--                <thead>-->
<!--                <tr>-->
<!--                    <th>Case ID</th>-->
<!--                    <th>Type</th>-->
<!--                    <th>District</th>-->
<!--                    <th>Status</th>-->
<!--                    <th>Assigned</th>-->
<!--                </tr>-->
<!--                </thead>-->
<!--                <tbody id="casesTableBody">-->
<!--                <tr>-->
<!--                    <td colspan="5" style="text-align: center; padding: 2rem;">Loading cases...</td>-->
<!--                </tr>-->
<!--                </tbody>-->
<!--            </table>-->
<!--        </div>-->

<!--        <div class="card">-->
<!--            <div class="chart-header">-->
<!--                <h3>Age Group Analysis</h3>-->
<!--                <button onclick="updateDemographics()" style="padding: 0.25rem 0.5rem; font-size: 0.75rem;">Update</button>-->
<!--            </div>-->
<!--            <table class="data-table">-->
<!--                <thead>-->
<!--                <tr>-->
<!--                    <th>Age Group</th>-->
<!--                    <th>Cases</th>-->
<!--                    <th>% of Total</th>-->
<!--                </tr>-->
<!--                </thead>-->
<!--                <tbody id="demographicsTableBody">-->
<!--                <tr>-->
<!--                    <td colspan="3" style="text-align: center; padding: 2rem;">Loading demographics...</td>-->
<!--                </tr>-->
<!--                </tbody>-->
<!--            </table>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--<div id="notification" class="notification"></div>-->

<!--<script>-->
<!--    // Global variables for charts-->
<!--    let regionChart, pieChart, trendChart;-->
<!--    let currentData = {};-->

<!--    // API Configuration - Update this to match your backend URL-->
<!--    const API_BASE = 'http://localhost:9002/api/analytics';-->

<!--    // API Client-->
<!--    class APIClient {-->
<!--        static async request(endpoint, options = {}) {-->
<!--            try {-->
<!--                const response = await fetch(`${API_BASE}${endpoint}`, {-->
<!--                    headers: {-->
<!--                        'Content-Type': 'application/json',-->
<!--                        ...options.headers-->
<!--                    },-->
<!--                    ...options-->
<!--                });-->

<!--                if (!response.ok) {-->
<!--                    throw new Error(`HTTP error! status: ${response.status} - ${response.statusText}`);-->
<!--                }-->

<!--                return await response.json();-->
<!--            } catch (error) {-->
<!--                console.error('API request failed:', error);-->
<!--                showNotification(`API Error: ${error.message}`, 'error');-->
<!--                throw error;-->
<!--            }-->
<!--        }-->

<!--        static async getDashboardAnalytics() {-->
<!--            return this.request('/dashboard');-->
<!--        }-->

<!--        static async getCaseStatistics() {-->
<!--            return this.request('/statistics');-->
<!--        }-->

<!--        static async getRegionAnalysis() {-->
<!--            return this.request('/regions');-->
<!--        }-->

<!--        static async getAbuseTypeAnalysis() {-->
<!--            return this.request('/abuse-types');-->
<!--        }-->

<!--        static async getMonthlyTrends() {-->
<!--            return this.request('/trends/monthly');-->
<!--        }-->

<!--        static async getAgeGroupAnalysis() {-->
<!--            return this.request('/age-groups');-->
<!--        }-->

<!--        static async getActiveCases() {-->
<!--            return this.request('/cases/active');-->
<!--        }-->

<!--        static async getClosedCases() {-->
<!--            return this.request('/cases/closed');-->
<!--        }-->

<!--        static async getStatusSummary() {-->
<!--            return this.request('/status-summary');-->
<!--        }-->

<!--        static async updateCaseStatus(caseId, status) {-->
<!--            return this.request(`/cases/${caseId}/status?status=${status}`, {-->
<!--                method: 'PUT'-->
<!--            });-->
<!--        }-->

<!--        static async getCasesByStatus(status) {-->
<!--            return this.request(`/cases/status/${status}`);-->
<!--        }-->
<!--    }-->

<!--    // Initialize dashboard-->
<!--    document.addEventListener('DOMContentLoaded', function() {-->
<!--        initializeCharts();-->
<!--        setupEventListeners();-->
<!--        loadInitialData();-->
<!--    });-->

<!--    function initializeCharts() {-->
<!--        // Region Chart-->
<!--        const regionCtx = document.getElementById('regionChart').getContext('2d');-->
<!--        regionChart = new Chart(regionCtx, {-->
<!--            type: 'bar',-->
<!--            data: {-->
<!--                labels: [],-->
<!--                datasets: [{-->
<!--                    label: 'Case Reports',-->
<!--                    data: [],-->
<!--                    backgroundColor: '#2563eb',-->
<!--                    borderColor: '#1d4ed8',-->
<!--                    borderWidth: 1-->
<!--                }]-->
<!--            },-->
<!--            options: {-->
<!--                responsive: false,-->
<!--                maintainAspectRatio: false,-->
<!--                plugins: {-->
<!--                    legend: { display: false }-->
<!--                },-->
<!--                scales: {-->
<!--                    y: { beginAtZero: true }-->
<!--                }-->
<!--            }-->
<!--        });-->

<!--        // Pie Chart-->
<!--        const pieCtx = document.getElementById('pieChart').getContext('2d');-->
<!--        pieChart = new Chart(pieCtx, {-->
<!--            type: 'doughnut',-->
<!--            data: {-->
<!--                labels: [],-->
<!--                datasets: [{-->
<!--                    data: [],-->
<!--                    backgroundColor: ['#dc2626', '#eab308', '#16a34a', '#2563eb'],-->
<!--                    borderWidth: 2,-->
<!--                    borderColor: '#ffffff'-->
<!--                }]-->
<!--            },-->
<!--            options: {-->
<!--                responsive: true,-->
<!--                maintainAspectRatio: false,-->
<!--                plugins: {-->
<!--                    legend: {-->
<!--                        position: 'bottom',-->
<!--                        labels: { padding: 10, font: { size: 11 } }-->
<!--                    }-->
<!--                }-->
<!--            }-->
<!--        });-->

<!--        // Trend Chart-->
<!--        const trendCtx = document.getElementById('trendChart').getContext('2d');-->
<!--        trendChart = new Chart(trendCtx, {-->
<!--            type: 'line',-->
<!--            data: {-->
<!--                labels: [],-->
<!--                datasets: [{-->
<!--                    label: 'Monthly Cases',-->
<!--                    data: [],-->
<!--                    borderColor: '#2563eb',-->
<!--                    backgroundColor: 'rgba(37, 99, 235, 0.1)',-->
<!--                    borderWidth: 3,-->
<!--                    fill: true,-->
<!--                    tension: 0.4-->
<!--                }]-->
<!--            },-->
<!--            options: {-->
<!--                responsive: false,-->
<!--                maintainAspectRatio: false,-->
<!--                plugins: {-->
<!--                    legend: { display: false }-->
<!--                },-->
<!--                scales: {-->
<!--                    y: { beginAtZero: true }-->
<!--                }-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--    function setupEventListeners() {-->
<!--        // Filter change events-->
<!--        const regionFilter = document.getElementById('regionFilter');-->
<!--        const caseTypeFilter = document.getElementById('caseTypeFilter');-->
<!--        const dateFrom = document.getElementById('dateFrom');-->
<!--        const dateTo = document.getElementById('dateTo');-->

<!--        if (regionFilter) regionFilter.addEventListener('change', applyFilters);-->
<!--        if (caseTypeFilter) caseTypeFilter.addEventListener('change', applyFilters);-->
<!--        if (dateFrom) dateFrom.addEventListener('change', applyFilters);-->
<!--        if (dateTo) dateTo.addEventListener('change', applyFilters);-->

<!--        // Refresh button-->
<!--        const refreshBtn = document.getElementById('refreshBtn');-->
<!--        if (refreshBtn) refreshBtn.addEventListener('click', refreshData);-->

<!--        // Export button-->
<!--        const exportBtn = document.getElementById('exportBtn');-->
<!--        if (exportBtn) exportBtn.addEventListener('click', exportData);-->
<!--    }-->

<!--    async function loadInitialData() {-->
<!--        try {-->
<!--            showNotification('Loading dashboard data...', 'success');-->
<!--            document.body.classList.add('loading');-->

<!--            // Load all dashboard data-->
<!--            const [-->
<!--                statistics,-->
<!--                regionData,-->
<!--                abuseTypeData,-->
<!--                trendsData,-->
<!--                ageGroupData,-->
<!--                activeCases,-->
<!--                statusSummary-->
<!--            ] = await Promise.all([-->
<!--                APIClient.getCaseStatistics(),-->
<!--                APIClient.getRegionAnalysis(),-->
<!--                APIClient.getAbuseTypeAnalysis(),-->
<!--                APIClient.getMonthlyTrends(),-->
<!--                APIClient.getAgeGroupAnalysis(),-->
<!--                APIClient.getActiveCases(),-->
<!--                APIClient.getStatusSummary()-->
<!--            ]);-->

<!--            // Update summary cards-->
<!--            updateSummaryCards(statistics, statusSummary);-->

<!--            // Update charts-->
<!--            updateRegionChartData(regionData);-->
<!--            updatePieChartData(abuseTypeData);-->
<!--            updateTrendChartData(trendsData);-->

<!--            // Update tables-->
<!--            updateCasesTable(activeCases);-->
<!--            updateDemographicsTable(ageGroupData);-->

<!--            currentData = {-->
<!--                statistics,-->
<!--                regions: regionData,-->
<!--                abuseTypes: abuseTypeData,-->
<!--                trends: trendsData,-->
<!--                ageGroups: ageGroupData,-->
<!--                activeCases,-->
<!--                statusSummary-->
<!--            };-->

<!--            document.body.classList.remove('loading');-->
<!--            showNotification('Dashboard loaded successfully', 'success');-->
<!--        } catch (error) {-->
<!--            document.body.classList.remove('loading');-->
<!--            showNotification('Failed to load dashboard data', 'error');-->
<!--            console.error('Dashboard load error:', error);-->
<!--            showErrorMessage('Failed to connect to the API. Please check if the backend server is running.');-->
<!--        }-->
<!--    }-->

<!--    function updateSummaryCards(statistics, statusSummary) {-->
<!--        // Update total cases-->
<!--        const totalCasesEl = document.getElementById('totalCases');-->
<!--        if (totalCasesEl) totalCasesEl.textContent = statistics.totalCases || '0';-->

<!--        // Update active cases-->
<!--        const activeCasesEl = document.getElementById('activeCases');-->
<!--        if (activeCasesEl) activeCasesEl.textContent = statistics.activeCases || '0';-->

<!--        // Update closed cases-->
<!--        const closedCasesEl = document.getElementById('closedCases');-->
<!--        if (closedCasesEl) closedCasesEl.textContent = statistics.closedCases || '0';-->

<!--        // Update reported cases-->
<!--        const reportedCasesEl = document.getElementById('reportedCases');-->
<!--        if (reportedCasesEl) reportedCasesEl.textContent = statusSummary.reportedCases || '0';-->

<!--        // Update trends-->
<!--        updateTrendIndicator('totalCasesTrend', '+12.3%', true);-->
<!--        updateTrendIndicator('activeCasesTrend', statistics.activeCases || '0', false);-->
<!--        updateTrendIndicator('closedCasesTrend', statistics.closedCases || '0', false);-->
<!--        updateTrendIndicator('reportedCasesTrend', statusSummary.reportedCases || '0', false);-->
<!--    }-->

<!--    function updateTrendIndicator(elementId, value, isPercentage) {-->
<!--        const element = document.getElementById(elementId);-->
<!--        if (!element) return;-->

<!--        if (isPercentage && value.startsWith('+')) {-->
<!--            element.innerHTML = `<span class="trend-up">↑ ${value.substring(1)}</span>`;-->
<!--        } else if (isPercentage && value.startsWith('-')) {-->
<!--            element.innerHTML = `<span class="trend-down">↓ ${value.substring(1)}</span>`;-->
<!--        } else {-->
<!--            element.textContent = value;-->
<!--        }-->
<!--    }-->

<!--    function updateRegionChartData(regionData) {-->
<!--        if (!regionData || regionData.length === 0) {-->
<!--            showNotification('No region data available', 'warning');-->
<!--            return;-->
<!--        }-->

<!--        const labels = regionData.map(item => item.region || item.regionName || 'Unknown');-->
<!--        const data = regionData.map(item => item.caseCount || item.cases || 0);-->

<!--        regionChart.data.labels = labels;-->
<!--        regionChart.data.datasets[0].data = data;-->
<!--        regionChart.update();-->
<!--    }-->

<!--    function updatePieChartData(abuseTypeData) {-->
<!--        if (!abuseTypeData || abuseTypeData.length === 0) {-->
<!--            showNotification('No abuse type data available', 'warning');-->
<!--            return;-->
<!--        }-->

<!--        const labels = abuseTypeData.map(item => formatAbuseType(item.abuseType || item.type));-->
<!--        const data = abuseTypeData.map(item => item.caseCount || item.cases || 0);-->

<!--        pieChart.data.labels = labels;-->
<!--        pieChart.data.datasets[0].data = data;-->
<!--        pieChart.update();-->
<!--    }-->

<!--    function updateTrendChartData(trendsData) {-->
<!--        if (!trendsData || trendsData.length === 0) {-->
<!--            showNotification('No trend data available', 'warning');-->
<!--            return;-->
<!--        }-->

<!--        const labels = trendsData.map(item => item.month || item.period || 'Unknown');-->
<!--        const data = trendsData.map(item => item.caseCount || item.cases || 0);-->

<!--        trendChart.data.labels = labels;-->
<!--        trendChart.data.datasets[0].data = data;-->
<!--        trendChart.update();-->
<!--    }-->

<!--    function updateCasesTable(activeCases) {-->
<!--        const tableBody = document.getElementById('casesTableBody');-->
<!--        if (!tableBody) return;-->

<!--        tableBody.innerHTML = '';-->

<!--        if (!activeCases || activeCases.length === 0) {-->
<!--            tableBody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 2rem;">No active cases found</td></tr>';-->
<!--            return;-->
<!--        }-->

<!--        // Show first 10 cases for dashboard view-->
<!--        const displayCases = activeCases.slice(0, 10);-->

<!--        displayCases.forEach(caseItem => {-->
<!--            const row = document.createElement('tr');-->
<!--            row.onclick = () => selectCase(caseItem.caseId);-->

<!--            row.innerHTML = `-->
<!--            <td>${caseItem.caseId || 'N/A'}</td>-->
<!--            <td>${formatAbuseType(caseItem.abuseType)}</td>-->
<!--            <td>${caseItem.district || caseItem.region || 'N/A'}</td>-->
<!--            <td><span class="badge badge-${getStatusClass(caseItem.status)}"-->
<!--                    onclick="updateCaseStatus('${caseItem.caseId}', event)">${formatStatus(caseItem.status)}</span></td>-->
<!--            <td>${caseItem.assignedTo || 'Unassigned'}</td>-->
<!--        `;-->

<!--            tableBody.appendChild(row);-->
<!--        });-->
<!--    }-->

<!--    function updateDemographicsTable(ageGroupData) {-->
<!--        const tableBody = document.getElementById('demographicsTableBody');-->
<!--        if (!tableBody) return;-->

<!--        tableBody.innerHTML = '';-->

<!--        if (!ageGroupData || ageGroupData.length === 0) {-->
<!--            tableBody.innerHTML = '<tr><td colspan="3" style="text-align: center; padding: 2rem;">No demographic data found</td></tr>';-->
<!--            return;-->
<!--        }-->

<!--        const totalCases = ageGroupData.reduce((sum, item) => sum + (item.caseCount || item.cases || 0), 0);-->

<!--        ageGroupData.forEach(group => {-->
<!--            const row = document.createElement('tr');-->
<!--            const cases = group.caseCount || group.cases || 0;-->
<!--            const percentage = totalCases > 0 ? ((cases / totalCases) * 100).toFixed(1) : '0.0';-->

<!--            row.innerHTML = `-->
<!--            <td>${group.ageGroup || 'Unknown'}</td>-->
<!--            <td>${cases}</td>-->
<!--            <td>${percentage}%</td>-->
<!--        `;-->

<!--            tableBody.appendChild(row);-->
<!--        });-->
<!--    }-->

<!--    function formatAbuseType(type) {-->
<!--        if (!type) return 'Unknown';-->

<!--        const typeMap = {-->
<!--            'PHYSICAL_ABUSE': 'Physical Abuse',-->
<!--            'EMOTIONAL_ABUSE': 'Emotional Abuse',-->
<!--            'SEXUAL_ABUSE': 'Sexual Abuse',-->
<!--            'NEGLECT': 'Neglect'-->
<!--        };-->
<!--        return typeMap[type] || type.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());-->
<!--    }-->

<!--    function formatStatus(status) {-->
<!--        if (!status) return 'Unknown';-->

<!--        const statusMap = {-->
<!--            'REPORTED': 'Reported',-->
<!--            'UNDER_INVESTIGATION': 'Under Investigation',-->
<!--            'IN_PROGRESS': 'In Progress',-->
<!--            'RESOLVED': 'Resolved',-->
<!--            'DISMISSED': 'Dismissed'-->
<!--        };-->
<!--        return statusMap[status] || status.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());-->
<!--    }-->

<!--    function getStatusClass(status) {-->
<!--        const statusClasses = {-->
<!--            'REPORTED': 'warning',-->
<!--            'UNDER_INVESTIGATION': 'warning',-->
<!--            'IN_PROGRESS': 'warning',-->
<!--            'RESOLVED': 'success',-->
<!--            'DISMISSED': 'danger'-->
<!--        };-->
<!--        return statusClasses[status] || 'warning';-->
<!--    }-->

<!--    async function updateRegionChart() {-->
<!--        try {-->
<!--            const filter = document.getElementById('regionChartFilter')?.value;-->
<!--            showNotification('Updating region chart...', 'success');-->
<!--            const regionData = await APIClient.getRegionAnalysis();-->
<!--            updateRegionChartData(regionData);-->
<!--            showNotification('Region chart updated', 'success');-->
<!--        } catch (error) {-->
<!--            showNotification('Failed to update region chart', 'error');-->
<!--        }-->
<!--    }-->

<!--    async function updateTrendChart() {-->
<!--        try {-->
<!--            const period = document.getElementById('trendPeriod')?.value;-->
<!--            showNotification('Updating trend chart...', 'success');-->
<!--            const trendsData = await APIClient.getMonthlyTrends();-->
<!--            updateTrendChartData(trendsData);-->
<!--            showNotification('Trend chart updated', 'success');-->
<!--        } catch (error) {-->
<!--            showNotification('Failed to update trend chart', 'error');-->
<!--        }-->
<!--    }-->

<!--    async function applyFilters() {-->
<!--        const regionFilter = document.getElementById('regionFilter');-->
<!--        const caseTypeFilter = document.getElementById('caseTypeFilter');-->
<!--        const dateFromFilter = document.getElementById('dateFrom');-->
<!--        const dateToFilter = document.getElementById('dateTo');-->

<!--        const region = regionFilter?.value;-->
<!--        const caseType = caseTypeFilter?.value;-->
<!--        const dateFrom = dateFromFilter?.value;-->
<!--        const dateTo = dateToFilter?.value;-->

<!--        showNotification('Applying filters...', 'success');-->
<!--        document.body.classList.add('loading');-->

<!--        try {-->
<!--            // For now, we'll reload all data since your API doesn't support filtering yet-->
<!--            // You can enhance your backend APIs to accept filter parameters-->
<!--            await loadInitialData();-->
<!--            showNotification('Filters applied successfully', 'success');-->
<!--        } catch (error) {-->
<!--            showNotification('Failed to apply filters', 'error');-->
<!--        } finally {-->
<!--            document.body.classList.remove('loading');-->
<!--        }-->
<!--    }-->

<!--    async function refreshData() {-->
<!--        showNotification('Refreshing data...', 'success');-->
<!--        document.body.classList.add('loading');-->

<!--        try {-->
<!--            await loadInitialData();-->
<!--            showNotification('Data refreshed successfully', 'success');-->
<!--        } catch (error) {-->
<!--            showNotification('Failed to refresh data', 'error');-->
<!--        } finally {-->
<!--            document.body.classList.remove('loading');-->
<!--        }-->
<!--    }-->

<!--    async function exportData() {-->
<!--        try {-->
<!--            showNotification('Exporting report...', 'success');-->

<!--            const exportData = {-->
<!--                generatedAt: new Date().toISOString(),-->
<!--                generatedBy: 'Analytics Dashboard',-->
<!--                summary: {-->
<!--                    totalCases: currentData.statistics?.totalCases || 0,-->
<!--                    activeCases: currentData.statistics?.activeCases || 0,-->
<!--                    closedCases: currentData.statistics?.closedCases || 0,-->
<!--                    reportedCases: currentData.statusSummary?.reportedCases || 0-->
<!--                },-->
<!--                regionAnalysis: currentData.regions || [],-->
<!--                abuseTypeAnalysis: currentData.abuseTypes || [],-->
<!--                monthlyTrends: currentData.trends || [],-->
<!--                ageGroupAnalysis: currentData.ageGroups || [],-->
<!--                activeCases: currentData.activeCases || []-->
<!--            };-->

<!--            const dataStr = JSON.stringify(exportData, null, 2);-->
<!--            const dataBlob = new Blob([dataStr], { type: 'application/json' });-->

<!--            const url = URL.createObjectURL(dataBlob);-->
<!--            const link = document.createElement('a');-->
<!--            link.href = url;-->
<!--            link.download = `analytics-report-${new Date().toISOString().split('T')[0]}.json`;-->
<!--            document.body.appendChild(link);-->
<!--            link.click();-->
<!--            document.body.removeChild(link);-->
<!--            URL.revokeObjectURL(url);-->

<!--            showNotification('Report exported successfully', 'success');-->
<!--        } catch (error) {-->
<!--            showNotification('Failed to export report', 'error');-->
<!--            console.error('Export error:', error);-->
<!--        }-->
<!--    }-->

<!--    async function selectCase(caseId) {-->
<!--        try {-->
<!--            showNotification(`Loading case details for ${caseId}...`, 'success');-->
<!--            // You can implement case detail modal or redirect to case detail page-->
<!--            console.log('Selected case:', caseId);-->

<!--            // Example: Open case detail modal or navigate to case page-->
<!--            // window.location.href = `/cases/${caseId}`;-->

<!--        } catch (error) {-->
<!--            showNotification('Failed to load case details', 'error');-->
<!--        }-->
<!--    }-->

<!--    async function updateCaseStatus(caseId, event) {-->
<!--        event.stopPropagation(); // Prevent row click-->

<!--        try {-->
<!--            // Show status update modal or dropdown-->
<!--            const newStatus = prompt('Enter new status (REPORTED, RESOLVED, DISMISSED):');-->
<!--            if (!newStatus) return;-->

<!--            showNotification(`Updating case ${caseId} status...`, 'success');-->

<!--            await APIClient.updateCaseStatus(caseId, newStatus.toUpperCase());-->

<!--            // Refresh the data to show updated status-->
<!--            await loadInitialData();-->

<!--            showNotification(`Case ${caseId} status updated successfully`, 'success');-->
<!--        } catch (error) {-->
<!--            showNotification('Failed to update case status', 'error');-->
<!--            console.error('Status update error:', error);-->
<!--        }-->
<!--    }-->

<!--    // Utility functions-->
<!--    function showNotification(message, type = 'info') {-->
<!--        // Create notification element if it doesn't exist-->
<!--        let notification = document.getElementById('notification');-->
<!--        if (!notification) {-->
<!--            notification = document.createElement('div');-->
<!--            notification.id = 'notification';-->
<!--            notification.style.cssText = `-->
<!--            position: fixed;-->
<!--            top: 20px;-->
<!--            right: 20px;-->
<!--            padding: 12px 20px;-->
<!--            border-radius: 4px;-->
<!--            color: white;-->
<!--            font-weight: 500;-->
<!--            z-index: 1000;-->
<!--            transition: all 0.3s ease;-->
<!--            max-width: 300px;-->
<!--        `;-->
<!--            document.body.appendChild(notification);-->
<!--        }-->

<!--        // Set notification style based on type-->
<!--        const colors = {-->
<!--            success: '#16a34a',-->
<!--            error: '#dc2626',-->
<!--            warning: '#eab308',-->
<!--            info: '#2563eb'-->
<!--        };-->

<!--        notification.style.backgroundColor = colors[type] || colors.info;-->
<!--        notification.textContent = message;-->
<!--        notification.style.display = 'block';-->
<!--        notification.style.opacity = '1';-->

<!--        // Auto-hide after 3 seconds-->
<!--        setTimeout(() => {-->
<!--            notification.style.opacity = '0';-->
<!--            setTimeout(() => {-->
<!--                notification.style.display = 'none';-->
<!--            }, 300);-->
<!--        }, 3000);-->
<!--    }-->

<!--    function showErrorMessage(message) {-->
<!--        // Create error overlay-->
<!--        const overlay = document.createElement('div');-->
<!--        overlay.style.cssText = `-->
<!--        position: fixed;-->
<!--        top: 0;-->
<!--        left: 0;-->
<!--        width: 100%;-->
<!--        height: 100%;-->
<!--        background: rgba(0,0,0,0.5);-->
<!--        display: flex;-->
<!--        align-items: center;-->
<!--        justify-content: center;-->
<!--        z-index: 2000;-->
<!--    `;-->

<!--        const modal = document.createElement('div');-->
<!--        modal.style.cssText = `-->
<!--        background: white;-->
<!--        padding: 30px;-->
<!--        border-radius: 8px;-->
<!--        max-width: 500px;-->
<!--        text-align: center;-->
<!--        box-shadow: 0 10px 25px rgba(0,0,0,0.2);-->
<!--    `;-->

<!--        modal.innerHTML = `-->
<!--        <h3 style="color: #dc2626; margin-bottom: 15px;">Connection Error</h3>-->
<!--        <p style="margin-bottom: 20px;">${message}</p>-->
<!--        <button onclick="this.closest('.error-overlay').remove()"-->
<!--                style="padding: 10px 20px; background: #2563eb; color: white;-->
<!--                       border: none; border-radius: 4px; cursor: pointer;">-->
<!--            OK-->
<!--        </button>-->
<!--    `;-->

<!--        overlay.className = 'error-overlay';-->
<!--        overlay.appendChild(modal);-->
<!--        document.body.appendChild(overlay);-->
<!--    }-->

<!--    // Initialize when DOM is loaded-->
<!--    if (document.readyState === 'loading') {-->
<!--        document.addEventListener('DOMContentLoaded', initializeDashboard);-->
<!--    } else {-->
<!--        initializeDashboard();-->
<!--    }-->

<!--    function initializeDashboard() {-->
<!--        console.log('Analytics Dashboard initialized');-->
<!--        // Additional initialization if needed-->
<!--    }-->
<!--</script>-->



<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Child Abuse Analytics Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #dc3545;
            --secondary: #6c757d;
            --success: #198754;
            --warning: #ffc107;
            --danger: #dc3545;
            --info: #0dcaf0;
            --light: #f8f9fa;
            --dark: #212529;
            --light-red: #fdf2f2;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
        }

        .main-content {
            padding: 20px;
        }

        .dashboard-header {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 25px;
            border-left: 4px solid var(--primary);
        }

        .dashboard-header h1 {
            color: var(--primary);
            font-weight: 700;
            margin: 0;
        }

        .dashboard-header p {
            color: var(--secondary);
            margin: 5px 0 0 0;
        }

        .controls-section {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 25px;
        }

        .controls-section h5 {
            color: var(--dark);
            font-weight: 600;
            margin-bottom: 15px;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
            border-left: 4px solid transparent;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .stat-card.total-cases {
            border-left-color: var(--primary);
        }

        .stat-card.active-cases {
            border-left-color: var(--warning);
        }

        .stat-card.closed-cases {
            border-left-color: var(--success);
        }

        .stat-card.reported-cases {
            border-left-color: var(--info);
        }

        .stat-card .icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 15px;
        }

        .stat-card.total-cases .icon {
            background: var(--light-red);
            color: var(--primary);
        }

        .stat-card.active-cases .icon {
            background: #fff3cd;
            color: var(--warning);
        }

        .stat-card.closed-cases .icon {
            background: #d1e7dd;
            color: var(--success);
        }

        .stat-card.reported-cases .icon {
            background: #cff4fc;
            color: var(--info);
        }

        .stat-card h2 {
            margin: 0;
            font-weight: 700;
            color: var(--dark);
            font-size: 2.5rem;
        }

        .stat-card p {
            margin: 5px 0 0 0;
            color: var(--secondary);
            font-weight: 500;
        }

        .stat-card .trend {
            font-size: 0.875rem;
            margin-top: 8px;
        }

        .trend-up {
            color: var(--success);
        }

        .trend-down {
            color: var(--danger);
        }

        .dashboard-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            height: 100%;
            margin-bottom: 20px;
        }

        .dashboard-card-header {
            background: linear-gradient(135deg, var(--primary), #e85d6b);
            color: white;
            padding: 20px;
            font-weight: 600;
            font-size: 1.1rem;
            display: flex;
            justify-content: between;
            align-items: center;
        }

        .dashboard-card-body {
            padding: 25px;
        }

        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }

        .chart-container canvas {
            max-height: 300px !important;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            background-color: var(--light);
            color: var(--dark);
            font-weight: 600;
            padding: 12px;
            text-align: left;
            border-bottom: 2px solid #dee2e6;
        }

        .data-table td {
            padding: 12px;
            border-bottom: 1px solid #dee2e6;
        }

        .data-table tbody tr:hover {
            background-color: var(--light);
            cursor: pointer;
        }

        .badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-success {
            background-color: var(--success);
            color: white;
        }

        .badge-warning {
            background-color: var(--warning);
            color: var(--dark);
        }

        .badge-danger {
            background-color: var(--danger);
            color: white;
        }

        .btn-custom {
            background: linear-gradient(135deg, var(--primary), #e85d6b);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-custom:hover {
            background: linear-gradient(135deg, #c02d3a, var(--primary));
            color: white;
            transform: translateY(-2px);
        }

        .form-select, .form-control {
            border-radius: 8px;
            border: 2px solid #e9ecef;
            padding: 10px 15px;
            transition: all 0.3s ease;
        }

        .form-select:focus, .form-control:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25);
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading-spinner {
            background: white;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
        }

        body.loading .loading-overlay {
            display: flex;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            transition: all 0.3s ease;
            max-width: 350px;
            display: none;
        }

        .alert-warning {
            background-color: #fff3cd;
            border-color: #ffecb5;
            color: #664d03;
        }

        .alert-danger {
            background-color: #f8d7da;
            border-color: #f5c2c7;
            color: #842029;
        }
    </style>
</head>
<body>
<!-- Loading Overlay -->
<div class="loading-overlay">
    <div class="loading-spinner">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-2 mb-0">Loading dashboard data...</p>
    </div>
</div>

<!-- Notification -->
<div id="notification" class="notification"></div>

<div class="main-content">
    <!-- Dashboard Header -->
    <div class="dashboard-header">
        <h1><i class="fas fa-shield-alt me-3"></i>Child Abuse Analytics Dashboard</h1>
        <p>Monitor and analyze child abuse case reports and investigations</p>
    </div>
    <!-- Stats Cards -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="stat-card total-cases" onclick="showCaseDetails('total')">
                <div class="icon">
                    <i class="fas fa-clipboard-list"></i>
                </div>
                <h2 id="totalCases">Loading...</h2>
                <p>Total Case Reports</p>
                <div class="trend" id="totalCasesTrend">--</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card active-cases" onclick="showCaseDetails('active')">
                <div class="icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <h2 id="activeCases">Loading...</h2>
                <p>Active Cases</p>
                <div class="trend" id="activeCasesTrend">currently active</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card closed-cases" onclick="showCaseDetails('closed')">
                <div class="icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <h2 id="closedCases">Loading...</h2>
                <p>Closed Cases</p>
                <div class="trend" id="closedCasesTrend">resolved cases</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="stat-card reported-cases" onclick="showCaseDetails('reported')">
                <div class="icon">
                    <i class="fas fa-bell"></i>
                </div>
                <h2 id="reportedCases">Loading...</h2>
                <p>Reported Cases</p>
                <div class="trend" id="reportedCasesTrend">pending investigation</div>
            </div>
        </div>
    </div>

    <!-- Charts Row -->
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="dashboard-card">
                <div class="dashboard-card-header">
                    <span><i class="fas fa-map-marked-alt me-2"></i>Reports by Region</span>
                    <select id="regionChartFilter" class="form-select form-select-sm ms-auto" style="width: auto;" onchange="updateRegionChart()">
                        <option value="all">All Case Types</option>
                        <option value="PHYSICAL_ABUSE">Physical Abuse</option>
                        <option value="EMOTIONAL_ABUSE">Emotional Abuse</option>
                        <option value="NEGLECT">Neglect</option>
                        <option value="SEXUAL_ABUSE">Sexual Abuse</option>
                    </select>
                </div>
                <div class="dashboard-card-body">
                    <div class="chart-container">
                        <canvas id="regionChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="dashboard-card">
                <div class="dashboard-card-header">
                    <i class="fas fa-chart-pie me-2"></i>Case Types Distribution
                </div>
                <div class="dashboard-card-body">
                    <div class="chart-container">
                        <canvas id="pieChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Monthly Trends Chart -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="dashboard-card">
                <div class="dashboard-card-header">
                    <span><i class="fas fa-chart-line me-2"></i>Monthly Trends</span>
                    <select id="trendPeriod" class="form-select form-select-sm ms-auto" style="width: auto;" onchange="updateTrendChart()">
                        <option value="6">Last 6 Months</option>
                        <option value="12" selected>Last 12 Months</option>
                        <option value="24">Last 24 Months</option>
                    </select>
                </div>
                <div class="dashboard-card-body">
                    <div class="chart-container">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Data Tables Row -->
    <div class="row">
        <div class="col-md-8">
            <div class="dashboard-card">
                <div class="dashboard-card-header">
                    <span><i class="fas fa-list me-2"></i>Recent Active Cases</span>
                    <a href="#" onclick="viewAllCases()" class="text-white text-decoration-none">
                        <small>View All <i class="fas fa-arrow-right ms-1"></i></small>
                    </a>
                </div>
                <div class="dashboard-card-body p-0">
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                            <tr>
                                <th>Case ID</th>
                                <th>Type</th>
                                <th>District</th>
                                <th>Status</th>
                                <th>Assigned</th>
                            </tr>
                            </thead>
                            <tbody id="casesTableBody">
                            <tr>
                                <td colspan="5" class="text-center py-4">Loading cases...</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="dashboard-card">
                <div class="dashboard-card-header">
                    <span><i class="fas fa-users me-2"></i>Age Group Analysis</span>
                    <button onclick="updateDemographics()" class="btn btn-sm btn-light">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
                <div class="dashboard-card-body p-0">
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                            <tr>
                                <th>Age Group</th>
                                <th>Cases</th>
                                <th>% of Total</th>
                            </tr>
                            </thead>
                            <tbody id="demographicsTableBody">
                            <tr>
                                <td colspan="3" class="text-center py-4">Loading demographics...</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>

<script>
    // Global variables for charts
    let regionChart, pieChart, trendChart;
    let currentData = {};

    // API Configuration - Update this to match your backend URL
    const API_BASE = 'http://localhost:9003/api/v1/admin/analytics';

    // API Client
    class APIClient {
        static async request(endpoint, options = {}) {
            try {
                const response = await fetch(`${API_BASE}${endpoint}`, {
                    headers: {
                        'Content-Type': 'application/json',
                        ...options.headers
                    },
                    ...options
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status} - ${response.statusText}`);
                }

                return await response.json();
            } catch (error) {
                console.error('API request failed:', error);
                showNotification(`API Error: ${error.message}`, 'error');
                throw error;
            }
        }

        static async getDashboardAnalytics() {
            return this.request('/dashboard');
        }

        static async getCaseStatistics() {
            return this.request('/statistics');
        }

        static async getRegionAnalysis() {
            return this.request('/regions');
        }

        static async getAbuseTypeAnalysis() {
            return this.request('/abuse-types');
        }

        static async getMonthlyTrends() {
            return this.request('/trends/monthly');
        }

        static async getAgeGroupAnalysis() {
            return this.request('/age-groups');
        }

        static async getActiveCases() {
            return this.request('/cases/active');
        }

        static async getClosedCases() {
            return this.request('/cases/closed');
        }

        static async getStatusSummary() {
            return this.request('/status-summary');
        }

        static async updateCaseStatus(caseId, status) {
            return this.request(`/cases/${caseId}/status?status=${status}`, {
                method: 'PUT'
            });
        }

        static async getCasesByStatus(status) {
            return this.request(`/cases/status/${status}`);
        }
    }

    // Initialize dashboard
    document.addEventListener('DOMContentLoaded', function() {
        initializeCharts();
        setupEventListeners();
        loadInitialData();
    });

    function initializeCharts() {
        // Region Chart
        const regionCtx = document.getElementById('regionChart').getContext('2d');
        regionChart = new Chart(regionCtx, {
            type: 'bar',
            data: {
                labels: [],
                datasets: [{
                    label: 'Case Reports',
                    data: [],
                    backgroundColor: 'rgba(220, 53, 69, 0.8)',
                    borderColor: 'rgba(220, 53, 69, 1)',
                    borderWidth: 2,
                    borderRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(0,0,0,0.1)'
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });

        // Pie Chart
        const pieCtx = document.getElementById('pieChart').getContext('2d');
        pieChart = new Chart(pieCtx, {
            type: 'doughnut',
            data: {
                labels: [],
                datasets: [{
                    data: [],
                    backgroundColor: [
                        'rgba(220, 53, 69, 0.8)',
                        'rgba(255, 193, 7, 0.8)',
                        'rgba(25, 135, 84, 0.8)',
                        'rgba(13, 202, 240, 0.8)'
                    ],
                    borderWidth: 3,
                    borderColor: '#ffffff'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            padding: 20,
                            font: { size: 12 },
                            usePointStyle: true
                        }
                    }
                }
            }
        });

        // Trend Chart
        const trendCtx = document.getElementById('trendChart').getContext('2d');
        trendChart = new Chart(trendCtx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: 'Monthly Cases',
                    data: [],
                    borderColor: 'rgba(220, 53, 69, 1)',
                    backgroundColor: 'rgba(220, 53, 69, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: 'rgba(220, 53, 69, 1)',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 6
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(0,0,0,0.1)'
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });
    }

    // function setupEventListeners() {
    //     // Filter change events
    //     const regionFilter = document.getElementById('regionFilter');
    //     const caseTypeFilter = document.getElementById('caseTypeFilter');
    //     const dateFrom = document.getElementById('dateFrom');
    //     const dateTo = document.getElementById('dateTo');
    //
    //     if (regionFilter) regionFilter.addEventListener('change', applyFilters);
    //     if (caseTypeFilter) caseTypeFilter.addEventListener('change', applyFilters);
    //     if (dateFrom) dateFrom.addEventListener('change', applyFilters);
    //     if (dateTo) dateTo.addEventListener('change', applyFilters);
    // }

    async function loadInitialData() {
        try {
            showNotification('Loading dashboard data...', 'info');
            document.body.classList.add('loading');

            // Simulate API data for demo purposes
            const mockData = {
                statistics: {
                    totalCases: 1247,
                    activeCases: 89,
                    closedCases: 1158
                },
                statusSummary: {
                    reportedCases: 23
                },
                regions: [
                    { region: 'Northern District', caseCount: 312 },
                    { region: 'Eastern District', caseCount: 298 },
                    { region: 'Central District', caseCount: 387 },
                    { region: 'Western District', caseCount: 250 }
                ],
                abuseTypes: [
                    { abuseType: 'PHYSICAL_ABUSE', caseCount: 456 },
                    { abuseType: 'EMOTIONAL_ABUSE', caseCount: 298 },
                    { abuseType: 'SEXUAL_ABUSE', caseCount: 234 },
                    { abuseType: 'NEGLECT', caseCount: 259 }
                ],
                trends: [
                    { month: 'Jan 2025', caseCount: 89 },
                    { month: 'Feb 2025', caseCount: 76 },
                    { month: 'Mar 2025', caseCount: 102 },
                    { month: 'Apr 2025', caseCount: 94 },
                    { month: 'May 2025', caseCount: 108 }
                ],
                activeCases: [
                    { caseId: 'CASE-2025-001', abuseType: 'PHYSICAL_ABUSE', district: 'Central District', status: 'UNDER_INVESTIGATION', assignedTo: 'John Smith' },
                    { caseId: 'CASE-2025-002', abuseType: 'NEGLECT', district: 'Northern District', status: 'REPORTED', assignedTo: 'Sarah Johnson' },
                    { caseId: 'CASE-2025-003', abuseType: 'EMOTIONAL_ABUSE', district: 'Eastern District', status: 'IN_PROGRESS', assignedTo: 'Mike Wilson' }
                ],
                ageGroups: [
                    { ageGroup: '0-5 years', caseCount: 245 },
                    { ageGroup: '6-10 years', caseCount: 398 },
                    { ageGroup: '11-15 years', caseCount: 456 },
                    { ageGroup: '16-18 years', caseCount: 148 }
                ]
            };

            // Update summary cards
            updateSummaryCards(mockData.statistics, mockData.statusSummary);

            // Update charts
            updateRegionChartData(mockData.regions);
            updatePieChartData(mockData.abuseTypes);
            updateTrendChartData(mockData.trends);

            // Update tables
            updateCasesTable(mockData.activeCases);
            updateDemographicsTable(mockData.ageGroups);

            currentData = mockData;

            document.body.classList.remove('loading');
            showNotification('Dashboard loaded successfully', 'success');
        } catch (error) {
            document.body.classList.remove('loading');
            showNotification('Failed to load dashboard data', 'error');
            console.error('Dashboard load error:', error);
        }
    }

    function updateSummaryCards(statistics, statusSummary) {
        // Update total cases
        const totalCasesEl = document.getElementById('totalCases');
        if (totalCasesEl) totalCasesEl.textContent = statistics.totalCases || '0';

        // Update active cases
        const activeCasesEl = document.getElementById('activeCases');
        if (activeCasesEl) activeCasesEl.textContent = statistics.activeCases || '0';

        // Update closed cases
        const closedCasesEl = document.getElementById('closedCases');
        if (closedCasesEl) closedCasesEl.textContent = statistics.closedCases || '0';

        // Update reported cases
        const reportedCasesEl = document.getElementById('reportedCases');
        if (reportedCasesEl) reportedCasesEl.textContent = statusSummary.reportedCases || '0';

        // Update trends
        updateTrendIndicator('totalCasesTrend', '+12.3% vs previous period', true);
    }
    function updateTrendIndicator(elementId, value, isPercentage) {
        const element = document.getElementById(elementId);
        if (!element) return;

        if (isPercentage && value.startsWith('+')) {
            element.innerHTML = `<span class="trend-up">↑ ${value.substring(1)}</span>`;
        } else if (isPercentage && value.startsWith('-')) {
            element.innerHTML = `<span class="trend-down">↓ ${value.substring(1)}</span>`;
        } else {
            element.textContent = value;
        }
    }

    function updateRegionChartData(regionData) {
        if (!regionData || regionData.length === 0) {
            showNotification('No region data available', 'warning');
            return;
        }

        const labels = regionData.map(item => item.region || item.regionName || 'Unknown');
        const data = regionData.map(item => item.caseCount || item.cases || 0);

        regionChart.data.labels = labels;
        regionChart.data.datasets[0].data = data;
        regionChart.update();
    }

    function updatePieChartData(abuseTypeData) {
        if (!abuseTypeData || abuseTypeData.length === 0) {
            showNotification('No abuse type data available', 'warning');
            return;
        }

        const labels = abuseTypeData.map(item => formatAbuseType(item.abuseType || item.type));
        const data = abuseTypeData.map(item => item.caseCount || item.cases || 0);

        pieChart.data.labels = labels;
        pieChart.data.datasets[0].data = data;
        pieChart.update();
    }

    function updateTrendChartData(trendsData) {
        if (!trendsData || trendsData.length === 0) {
            showNotification('No trend data available', 'warning');
            return;
        }

        const labels = trendsData.map(item => item.month || item.period || 'Unknown');
        const data = trendsData.map(item => item.caseCount || item.cases || 0);

        trendChart.data.labels = labels;
        trendChart.data.datasets[0].data = data;
        trendChart.update();
    }

    function updateCasesTable(activeCases) {
        const tableBody = document.getElementById('casesTableBody');
        if (!tableBody) return;

        tableBody.innerHTML = '';

        if (!activeCases || activeCases.length === 0) {
            tableBody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 2rem;">No active cases found</td></tr>';
            return;
        }

        // Show first 10 cases for dashboard view
        const displayCases = activeCases.slice(0, 10);

        displayCases.forEach(caseItem => {
            const row = document.createElement('tr');
            row.onclick = () => selectCase(caseItem.caseId);

            row.innerHTML = `
            <td>${caseItem.caseId || 'N/A'}</td>
            <td>${formatAbuseType(caseItem.abuseType)}</td>
            <td>${caseItem.district || caseItem.region || 'N/A'}</td>
            <td><span class="badge badge-${getStatusClass(caseItem.status)}"
                    onclick="updateCaseStatus('${caseItem.caseId}', event)">${formatStatus(caseItem.status)}</span></td>
            <td>${caseItem.assignedTo || 'Unassigned'}</td>
        `;

            tableBody.appendChild(row);
        });
    }

    function updateDemographicsTable(ageGroupData) {
        const tableBody = document.getElementById('demographicsTableBody');
        if (!tableBody) return;

        tableBody.innerHTML = '';

        if (!ageGroupData || ageGroupData.length === 0) {
            tableBody.innerHTML = '<tr><td colspan="3" style="text-align: center; padding: 2rem;">No demographic data found</td></tr>';
            return;
        }

        const totalCases = ageGroupData.reduce((sum, item) => sum + (item.caseCount || item.cases || 0), 0);

        ageGroupData.forEach(group => {
            const row = document.createElement('tr');
            const cases = group.caseCount || group.cases || 0;
            const percentage = totalCases > 0 ? ((cases / totalCases) * 100).toFixed(1) : '0.0';

            row.innerHTML = `
            <td>${group.ageGroup || 'Unknown'}</td>
            <td>${cases}</td>
            <td>${percentage}%</td>
        `;

            tableBody.appendChild(row);
        });
    }

    function formatAbuseType(type) {
        if (!type) return 'Unknown';

        const typeMap = {
            'PHYSICAL_ABUSE': 'Physical Abuse',
            'EMOTIONAL_ABUSE': 'Emotional Abuse',
            'SEXUAL_ABUSE': 'Sexual Abuse',
            'NEGLECT': 'Neglect'
        };
        return typeMap[type] || type.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
    }

    function formatStatus(status) {
        if (!status) return 'Unknown';

        const statusMap = {
            'REPORTED': 'Reported',
            'UNDER_INVESTIGATION': 'Under Investigation',
            'IN_PROGRESS': 'In Progress',
            'RESOLVED': 'Resolved',
            'DISMISSED': 'Dismissed'
        };
        return statusMap[status] || status.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
    }

    function getStatusClass(status) {
        const statusClasses = {
            'REPORTED': 'warning',
            'UNDER_INVESTIGATION': 'warning',
            'IN_PROGRESS': 'warning',
            'RESOLVED': 'success',
            'DISMISSED': 'danger'
        };
        return statusClasses[status] || 'warning';
    }

    async function updateRegionChart() {
        try {
            const filter = document.getElementById('regionChartFilter')?.value;
            showNotification('Updating region chart...', 'success');
            const regionData = await APIClient.getRegionAnalysis();
            updateRegionChartData(regionData);
            showNotification('Region chart updated', 'success');
        } catch (error) {
            showNotification('Failed to update region chart', 'error');
        }
    }

    async function updateTrendChart() {
        try {
            const period = document.getElementById('trendPeriod')?.value;
            showNotification('Updating trend chart...', 'success');
            const trendsData = await APIClient.getMonthlyTrends();
            updateTrendChartData(trendsData);
            showNotification('Trend chart updated', 'success');
        } catch (error) {
            showNotification('Failed to update trend chart', 'error');
        }
    }

    async function applyFilters() {
        const regionFilter = document.getElementById('regionFilter');
        const caseTypeFilter = document.getElementById('caseTypeFilter');
        const dateFromFilter = document.getElementById('dateFrom');
        const dateToFilter = document.getElementById('dateTo');

        const region = regionFilter?.value;
        const caseType = caseTypeFilter?.value;
        const dateFrom = dateFromFilter?.value;
        const dateTo = dateToFilter?.value;

        showNotification('Applying filters...', 'success');
        document.body.classList.add('loading');

        try {
            // For now, we'll reload all data since your API doesn't support filtering yet
            // You can enhance your backend APIs to accept filter parameters
            await loadInitialData();
            showNotification('Filters applied successfully', 'success');
        } catch (error) {
            showNotification('Failed to apply filters', 'error');
        } finally {
            document.body.classList.remove('loading');
        }
    }

    async function refreshData() {
        showNotification('Refreshing data...', 'success');
        document.body.classList.add('loading');

        try {
            await loadInitialData();
            showNotification('Data refreshed successfully', 'success');
        } catch (error) {
            showNotification('Failed to refresh data', 'error');
        } finally {
            document.body.classList.remove('loading');
        }
    }

    async function exportData() {
        try {
            showNotification('Exporting report...', 'success');

            const exportData = {
                generatedAt: new Date().toISOString(),
                generatedBy: 'Analytics Dashboard',
                summary: {
                    totalCases: currentData.statistics?.totalCases || 0,
                    activeCases: currentData.statistics?.activeCases || 0,
                    closedCases: currentData.statistics?.closedCases || 0,
                    reportedCases: currentData.statusSummary?.reportedCases || 0
                },
                regionAnalysis: currentData.regions || [],
                abuseTypeAnalysis: currentData.abuseTypes || [],
                monthlyTrends: currentData.trends || [],
                ageGroupAnalysis: currentData.ageGroups || [],
                activeCases: currentData.activeCases || []
            };

            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });

            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `analytics-report-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);

            showNotification('Report exported successfully', 'success');
        } catch (error) {
            showNotification('Failed to export report', 'error');
            console.error('Export error:', error);
        }
    }

    async function selectCase(caseId) {
        try {
            showNotification(`Loading case details for ${caseId}...`, 'success');
            // You can implement case detail modal or redirect to case detail page
            console.log('Selected case:', caseId);

            // Example: Open case detail modal or navigate to case page
            // window.location.href = `/cases/${caseId}`;

        } catch (error) {
            showNotification('Failed to load case details', 'error');
        }
    }

    async function updateCaseStatus(caseId, event) {
        event.stopPropagation(); // Prevent row click

        try {
            // Show status update modal or dropdown
            const newStatus = prompt('Enter new status (REPORTED, RESOLVED, DISMISSED):');
            if (!newStatus) return;

            showNotification(`Updating case ${caseId} status...`, 'success');

            await APIClient.updateCaseStatus(caseId, newStatus.toUpperCase());

            // Refresh the data to show updated status
            await loadInitialData();

            showNotification(`Case ${caseId} status updated successfully`, 'success');
        } catch (error) {
            showNotification('Failed to update case status', 'error');
            console.error('Status update error:', error);
        }
    }

    // Utility functions
    function showNotification(message, type = 'info') {
        // Create notification element if it doesn't exist
        let notification = document.getElementById('notification');
        if (!notification) {
            notification = document.createElement('div');
            notification.id = 'notification';
            notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 4px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            transition: all 0.3s ease;
            max-width: 300px;
        `;
            document.body.appendChild(notification);
        }

        // Set notification style based on type
        const colors = {
            success: '#16a34a',
            error: '#dc2626',
            warning: '#eab308',
            info: '#2563eb'
        };

        notification.style.backgroundColor = colors[type] || colors.info;
        notification.textContent = message;
        notification.style.display = 'block';
        notification.style.opacity = '1';

        // Auto-hide after 3 seconds
        setTimeout(() => {
            notification.style.opacity = '0';
            setTimeout(() => {
                notification.style.display = 'none';
            }, 300);
        }, 3000);
    }

    function showErrorMessage(message) {
        // Create error overlay
        const overlay = document.createElement('div');
        overlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2000;
    `;

        const modal = document.createElement('div');
        modal.style.cssText = `
        background: white;
        padding: 30px;
        border-radius: 8px;
        max-width: 500px;
        text-align: center;
        box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    `;

        modal.innerHTML = `
        <h3 style="color: #dc2626; margin-bottom: 15px;">Connection Error</h3>
        <p style="margin-bottom: 20px;">${message}</p>
        <button onclick="this.closest('.error-overlay').remove()"
                style="padding: 10px 20px; background: #2563eb; color: white;
                       border: none; border-radius: 4px; cursor: pointer;">
            OK
        </button>
    `;

        overlay.className = 'error-overlay';
        overlay.appendChild(modal);
        document.body.appendChild(overlay);
    }

    // Initialize when DOM is loaded
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeDashboard);
    } else {
        initializeDashboard();
    }

    function initializeDashboard() {
        console.log('Analytics Dashboard initialized');
        // Additional initialization if needed
    }
</script>
</body>
</html>
